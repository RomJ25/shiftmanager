@page
@model ShiftManager.Pages.Auth.SignupModel
@using Microsoft.Extensions.Localization
@using ShiftManager.Resources
@using ShiftManager.Models.Support
@inject IStringLocalizer<SharedResources> Localizer
@{
    Layout = "_Layout";
}
<div class="card" style="max-width:480px; margin:auto">
    <h2>@Localizer["RequestAccess"]</h2>

    @if (!string.IsNullOrEmpty(Model.PendingRequestMessage))
    {
        <div class="card" style="background:var(--success-bg, #d4edda); color:var(--success-text, #155724); border-color:var(--success, #c3e6cb); padding:1rem; margin-bottom:1rem">
            <strong>âœ“ @Localizer["RequestSubmitted"]</strong>
            <p style="margin:.5rem 0 0 0">@Model.PendingRequestMessage</p>
        </div>
    }

    @if (!string.IsNullOrEmpty(Model.Error))
    {
        <div class="small" style="color:var(--danger); margin-bottom:.75rem">@Model.Error</div>
    }

    <form method="post" asp-page="./Signup">
        @Html.AntiForgeryToken()
        <div style="display:grid; gap:.75rem; margin-top:.75rem">
            <label>
                @Localizer["Email"]<br />
                <input class="input" asp-for="Email" type="email" required />
            </label>

            <label>
                @Localizer["DisplayName"]<br />
                <input class="input" asp-for="DisplayName" required />
            </label>

            <label>
                @Localizer["PasswordMinCharacters"]<br />
                <input class="input" asp-for="Password" type="password" minlength="6" required />
            </label>

            <label>
                @Localizer["Company"]<br />
                <select class="input" asp-for="CompanyId" required>
                    <option value="">@Localizer["SelectCompany"]</option>
                    @foreach (var company in Model.AvailableCompanies)
                    {
                        <option value="@company.Id">@company.Name</option>
                    }
                </select>
            </label>

            <label>
                @Localizer["RequestedRole"]<br />
                <select class="input" asp-for="RequestedRole" required>
                    <option value="@((int)UserRole.Employee)">@Localizer["Employee"]</option>
                    <option value="@((int)UserRole.Manager)">@Localizer["Manager"]</option>
                    <option value="@((int)UserRole.Director)">@Localizer["Director"]</option>
                </select>
                <small style="color:var(--muted, #6c757d)">@Localizer["RequestNeedsApproval"]</small>
            </label>

            <button class="btn btn-primary" type="submit">@Localizer["SubmitRequest"]</button>
        </div>
    </form>

    <div class="small" style="margin-top:1rem; text-align:center">
        @Localizer["AlreadyHaveAccount"] <a href="/Auth/Login">@Localizer["LoginHere"]</a>
    </div>
</div>
